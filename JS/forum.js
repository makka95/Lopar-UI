var lastFocus;$.fn.insertAtCaret = function(myValue) {	return this.each(function() {		var me = this;		if (document.selection) { // IE			me.focus();			sel = document.selection.createRange();			sel.text = myValue;			me.focus();		} else if (me.selectionStart || me.selectionStart == '0') { // Real browsers			var startPos = me.selectionStart, endPos = me.selectionEnd, scrollTop = me.scrollTop;			me.value = me.value.substring(0, startPos) + myValue + me.value.substring(endPos, me.value.length);			me.focus();			me.selectionStart = startPos + myValue.length;			me.selectionEnd = startPos + myValue.length;			me.scrollTop = scrollTop;		} else {			me.value += myValue;			me.focus();		}	});};$("textarea.create-post").focus(function() {    lastFocus = this;});function bold (clicked) {	var textarea = $("textarea.create-post");	if (lastFocus) {       lastFocus.focus();    } else {    	textarea.focus();    }	if($(textarea).is(":focus")) {		if(clicked == "bold") {			$(textarea).insertAtCaret("[BOLD][/BOLD]");		} else if (clicked == "italic") {			$(textarea).insertAtCaret("[ITALIC][/ITALIC]");		} else if (clicked == "underlined") {			$(textarea).insertAtCaret("[UNDERLINED][/UNDERLINED]");		} else if (clicked == "left") {			$(textarea).insertAtCaret("[LEFT][/LEFT]");		} else if (clicked == "center") {			$(textarea).insertAtCaret("[CENTER][/CENTER]");		} else if (clicked == "right") {			$(textarea).insertAtCaret("[RIGHT][/RIGHT]");		} else if (clicked == "link") {			$(textarea).insertAtCaret("[LINK PAGE=''][/LINK]");		} else if (clicked == "image") {			$(textarea).insertAtCaret("[IMAGE ADDRESS=''][/IMAGE]");		} else if (clicked == "paragraph") {			$(textarea).insertAtCaret("[PARAGRAPH][/PARAGRAPH]");		} else if (clicked == "list") {			$(textarea).insertAtCaret("[LIST][ITEM][/ITEM][ITEM][/ITEM][/LIST]");		}	} else {		if(clicked == "bold") {			$(textarea).html($(textarea).html() + "[BOLD][/BOLD]");		} else if (clicked == "italic") {			$(textarea).html($(textarea).html() + "[ITALIC][/ITALIC]");		} else if (clicked == "underlined") {			$(textarea).html($(textarea).html() + "[UNDERLINED][/UNDERLINED]");		} else if (clicked == "left") {			$(textarea).html($(textarea).html() + "[LEFT][/LEFT]");		} else if (clicked == "center") {			$(textarea).html($(textarea).html() + "[CENTER][/CENTER]");		} else if (clicked == "right") {			$(textarea).html($(textarea).html() + "[RIGHT][/RIGHT]");		} else if (clicked == "link") {			$(textarea).html($(textarea).html() + "[LINK PAGE=''][/LINK]");		} else if (clicked == "image") {			$(textarea).html($(textarea).html() + "[IMAGE ADDRESS=''][/ADDRESS]");		} else if (clicked == "paragraph") {			$(textarea).html($(textarea).html() + "[PARAGRAPH][/PARAGRAPH]");		} else if (clicked == "list") {			$(textarea).html($(textarea).html() + "[LIST][ITEM][/ITEM][ITEM][/ITEM][/LIST]");		}	}}